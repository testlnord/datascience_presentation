scale_y_continuous(labels = scales::percent) + theme_bw() + theme(legend.position = 'bottom') + coord_flip()
activities <- inner_join(pro.activities, hob.activities, by=c('activity')) %>% filter(activity != "Other ... Write In:") %>% setNames(c("activity", "Professionals", "Hobbyists")) %>% tidyr::gather(type, share, - activity)
ggplot(activities, aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent) + theme_bw() + theme(legend.position = 'bottom') + coord_flip()
ggplot(activities, aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent) + theme_bw() + theme(legend.position = 'bottom', axis.title.x=element_blank()) + coord_flip() + ylim(0,1) +
ggplot(activities, aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent) + theme_bw() + theme(legend.position = 'bottom', axis.title.x=element_blank()) + coord_flip() + ylim(0,1)
ggplot(activities, aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent) + theme_bw() + theme(legend.position = 'bottom', axis.title.x=element_blank()) + coord_flip() + ylim(0,1)
ggplot(activities, aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank()) + coord_flip()
ggplot(activities %>% arrange(share), aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank()) + coord_flip()
ggplot(activities, aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank()) + coord_flip()
ggplot(activities, aes(activity, share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?")) %>%
tidyr::gather(lang, is.use) %>% group_by(lang) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lang = stringr::str_replace(lang, ":.*", ""))
langs
data.clean.world$Time
data.clean.world %>% nrow
ggplot(lagns, aes(lang, share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?")) %>%
tidyr::gather(lang, is.use) %>% group_by(lang) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lang = stringr::str_replace(lang, ":.*", ""))
ggplot(lagns, aes(lang, share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs, aes(lang, share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs, aes(reorder(lang, -share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs, aes(reorder(lang, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?")) %>%
tidyr::gather(lang, is.use) %>% group_by(lang) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lang = stringr::str_replace(lang, ":.*", "")) %>% filter(lang != "Other ... Write In")
ggplot(langs, aes(reorder(lang, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?"), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`) %>%
mutate(experience = if_else(is.na(`How long have you been working in data analysis?`), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`)) %>%
select(-`How long have you been working in data analysis?`, -`How long have you been involved in data analysis?`)
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?"), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`) %>%
mutate(experience = if_else(is.na(`How long have you been working in data analysis?`), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`)) %>%
select(-`How long have you been working in data analysis?`, -`How long have you been involved in data analysis?`) %>%
tidyr::gather(lang, is.use, -experience) %>% group_by(lang, experience) %>% summarise(count.users = sum(!is.na(is.use)), count.all = n()) %>% ungroup() %>%
group_by(experience) %>% mutate(share.users  = count.users / sum(count.all)) %>%
mutate(lang = stringr::str_replace(lang, ":.*", "")) %>% filter(lang != "Other ... Write In")
lagns
langs
langs %>% filter(experience=='Less than 1 year')
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?"), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`) %>%
mutate(experience = if_else(is.na(`How long have you been working in data analysis?`), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`)) %>%
select(-`How long have you been working in data analysis?`, -`How long have you been involved in data analysis?`) %>%
tidyr::gather(lang, is.use, -experience) %>% group_by(lang, experience) %>% summarise(count.users = sum(!is.na(is.use)), count.all = n()) %>% ungroup() %>%
group_by(experience) %>% mutate(share.users  = count.users / sum(count.all)) %>%
mutate(lang = stringr::str_replace(lang, ":.*", "")) %>% filter(lang != "Other ... Write In")
ggplot(langs, aes(reorder(lang, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs, aes(reorder(experince, share.users, color=lang, group=lang), share)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
mutate(lang = stringr::str_replace(lang, ":.*", "")) %>% filter(lang != "Other ... Write In")
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?"), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`) %>%
mutate(experience = if_else(is.na(`How long have you been working in data analysis?`), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`)) %>%
select(-`How long have you been working in data analysis?`, -`How long have you been involved in data analysis?`) %>%
tidyr::gather(lang, is.use, -experience) %>% group_by(lang, experience) %>% summarise(count.users = sum(!is.na(is.use)), count.all = n()) %>% ungroup() %>%
group_by(experience) %>% mutate(share.users  = count.users / sum(count.all)) %>% ungroup() %>%
mutate(lang = stringr::str_replace(lang, ":.*", "")) %>% filter(lang != "Other ... Write In")
ggplot(langs, aes(experience, share.users, color=lang, group=lang)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs, aes(experience, share.users, fill=lang, group=lang)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?"), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`) %>%
mutate(experience = if_else(is.na(`How long have you been working in data analysis?`), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`)) %>%
select(-`How long have you been working in data analysis?`, -`How long have you been involved in data analysis?`) %>%
tidyr::gather(lang, is.use, -experience) %>% group_by(lang, experience) %>% summarise(count.users = sum(!is.na(is.use)), count.all = n()) %>% ungroup() %>%
group_by(experience) %>% mutate(share.users  = count.users / count.all) %>% ungroup() %>%
mutate(lang = stringr::str_replace(lang, ":.*", "")) %>% filter(lang != "Other ... Write In")
ggplot(langs, aes(experience, share.users, fill=lang, group=lang)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
langs
langs %>% filter(experience=='Less than 1 year')
langs$share.users
sum(langs$share.users)
sum(langs$lang)
langs$lang
table(langs$lang)
table(langs$experience)
ggplot(langs, aes(experience, share.users, fill=lang)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
langs <- data.clean.world %>%
select(ends_with(":What programming language(s) do you regularly use for data analysis, if any?"), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`) %>%
mutate(experience = if_else(is.na(`How long have you been working in data analysis?`), `How long have you been involved in data analysis?`, `How long have you been working in data analysis?`)) %>%
select(-`How long have you been working in data analysis?`, -`How long have you been involved in data analysis?`) %>%
tidyr::gather(lang, is.use, -experience) %>% group_by(lang, experience) %>% summarise(count.users = sum(!is.na(is.use)), count.all = n()) %>% ungroup() %>%
group_by(experience) %>% mutate(share.users  = count.users / count.all) %>% ungroup() %>%
mutate(lang = stringr::str_replace(lang, ":.*", "")) #%>% filter(lang != "Other ... Write In")
ggplot(langs, aes(experience, share.users, fill=lang)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs, aes(experience, share.users, fill=lang)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs %>% filter(!is.na(experience)) %>% filter(lang %in% c("R", "Python")),
aes(experience, share.users, fill=lang)) + geom_bar(stat='identity') +
scale_y_continuous(labels = scales::percent) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs %>% filter(!is.na(experience)) %>% filter(lang %in% c("R", "Python")),
aes(experience, share.users, fill=lang)) + geom_bar(stat='identity', position="dodge") +
scale_y_continuous(labels = scales::percent, limits=c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs %>% filter(!is.na(experience)) %>% filter(lang %in% c("R", "Python")),
aes(arrange(experience, -experience), share.users, fill=lang)) + geom_bar(stat='identity', position="dodge") +
scale_y_continuous(labels = scales::percent, limits=c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs %>% filter(!is.na(experience)) %>% filter(lang %in% c("R", "Python")),
aes(reorder(experience, -experience), share.users, fill=lang)) + geom_bar(stat='identity', position="dodge") +
scale_y_continuous(labels = scales::percent, limits=c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(langs %>% filter(!is.na(experience)) %>% filter(lang %in% c("R", "Python")),
aes(reorder(experience, experience), share.users, fill=lang)) + geom_bar(stat='identity', position="dodge") +
scale_y_continuous(labels = scales::percent, limits=c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
?reorder
ggplot(langs %>% filter(!is.na(experience)) %>% filter(lang %in% c("R", "Python")),
aes(experience, share.users, fill=lang)) + geom_bar(stat='identity', position="dodge") +
scale_y_continuous(labels = scales::percent, limits=c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + scale_x_discrete(limits = rev(levels(experience))) + coord_flip()
ggplot(langs %>% filter(!is.na(experience)) %>% filter(lang %in% c("R", "Python")),
aes(experience, share.users, fill=lang)) + geom_bar(stat='identity', position="dodge") +
scale_y_continuous(labels = scales::percent, limits=c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + scale_x_discrete(limits = rev(levels(langs$experience))) + coord_flip()
future.langs <- data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?` %>% table %>% magrittr::divide_by(sum(!is.na(data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?`)))
future.langs
future.langs %>% as.data.frame()
future.langs <- data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?` %>% table %>% magrittr::divide_by(sum(!is.na(data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?`))) %>% as.data.frame() %>% setNames(c('lang', 'share'))
ggplot(future.langs, aes(reorder(lang, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
future.langs <- data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?` %>% table %>% magrittr::divide_by(sum(!is.na(data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?`))) %>% as.data.frame() %>% setNames(c('lang', 'share')) %>%
filter(lang != "None", lang != "Other – Write In:")
ggplot(future.langs, aes(reorder(lang, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
future.langs.R  <- data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?`[!is.na(data.clean.world$`R:What programming language(s) do you regularly use for data analysis, if any?`)] %>% table %>% magrittr::divide_by(sum(!is.na(data.clean.world$`R:What programming language(s) do you regularly use for data analysis, if any?`))) %>% as.data.frame() %>% setNames(c('lang', 'share')) %>%
filter(lang != "None", lang != "Other – Write In:")
future.langs.R  <- data.clean.world$`In your opinion, what programming language will be most used for data analysis in the next 5 years?`[!is.na(data.clean.world$`R:What programming language(s) do you regularly use for data analysis, if any?`)] %>% table %>% magrittr::divide_by(sum(!is.na(data.clean.world$`R:What programming language(s) do you regularly use for data analysis, if any?`))) %>% as.data.frame() %>% setNames(c('lang', 'share')) %>%
filter(lang != "None", lang != "Other – Write In:")
future.langs.R
future.langs
rlibs <- data.clean.world %>% filter(!is.na(`R:What programming language(s) do you regularly use for data analysis, if any?`)) %>%
select(ends_with(":What data analysis and/or data visualization libraries do you use with R, if any?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lang, ":.*", "")) %>% filter(lib != "Other ... Write In")
rlibs <- data.clean.world %>% filter(!is.na(`R:What programming language(s) do you regularly use for data analysis, if any?`)) %>%
select(ends_with(":What data analysis and/or data visualization libraries do you use with R, if any?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In")
ggplot(rlibs, aes(reorder(lib, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
ggplot(rlibs, aes(reorder(lib, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=20), legend.title = element_blank()) + coord_flip()
ggplot(rlibs, aes(reorder(lib, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=15), legend.title = element_blank()) + coord_flip()
rlibs <- data.clean.world %>% filter(!is.na(`R:What programming language(s) do you regularly use for data analysis, if any?`)) %>%
select(ends_with(":What data analysis and/or data visualization libraries do you use with R, if any?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>% top_n(share, 10)
rlibs <- data.clean.world %>% filter(!is.na(`R:What programming language(s) do you regularly use for data analysis, if any?`)) %>%
select(ends_with(":What data analysis and/or data visualization libraries do you use with R, if any?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>% top_n(10, share)
ggplot(rlibs, aes(reorder(lib, share), share)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=15), legend.title = element_blank()) + coord_flip()
knitr::opts_chunk$set(echo = FALSE)
load("data.clean.rda")
library(readr)
library(dplyr)
library(ggplot2)
data.clean.rus <- read_csv("ds_rus_clean_data.csv", col_types = cols(
.default = col_character(),
`На каком курсе Вы учитесь:` = col_integer()
))
data.clean.world <- data.clean %>% filter(`For you, data analysis is...?` != "I'm not involved in data analysis")
survey.designs.by.ctr <- list(
'USA' = subset(data.clean.world, `What country do you live in?` == 'United States'),
'Japan' = subset(data.clean.world, `What country do you live in?` == 'Japan'),
'China' = subset(data.clean.world, `What country do you live in?` == 'China'),
'Europe' = subset(data.clean.world, `What country do you live in?` %in% europe_countries)
)
other_countries = c("Brazil", "Jordan", "India", "Russia", "Kenya", "Peru", "Belarus", "Honduras","Australia", "Uruguay", "Georgia","Ethiopia", "Hong Kong", "Fiji", "Nepal", "Philippines", "Montenegro","Mexico","Vietnam", "Pakistan", "Taiwan", "Austria", "Bolivia", "Bangladesh", "South Africa", "Chile", "South Korea", "Antigua and Barbuda","Armenia", "Afghanistan", "Lebanon", "Iraq", "Mauritania", "Azerbaijan",
"Uganda", "Tanzania", "Myanmar", "Sri Lanka")
europe_countries = c("France", "Switzerland", "Germany", "Poland", "Turkey", "Ukraine",
"Portugal", "Czech Republic", "Spain", "Netherlands", "Italy",
"Greece", "Argentina", "Sweden", "Belgium", "Romania", "Hungary",
"Estonia", "Denmark", "Canada",  "Lithuania", "Norway", "Andorra",
"Slovenia", "Indonesia", "Croatia", "Cyprus", "Iceland", "Serbia",
"Macedonia", "Ireland")
survey.designs.by.ctr <- list(
'USA' = subset(data.clean.world, `What country do you live in?` == 'United States'),
'Japan' = subset(data.clean.world, `What country do you live in?` == 'Japan'),
'China' = subset(data.clean.world, `What country do you live in?` == 'China'),
'Europe' = subset(data.clean.world, `What country do you live in?` %in% europe_countries)
)
survey.designs.by.ctr$Japan %>% nrow
lapply(survey.designs.by.ctr, lapplt)
lapply(survey.designs.by.ctr, lapply)
lapply(survey.designs.by.ctr, nrow)
data.clean.world %>% select(ends_with(":Which..tool(s) do you use for data analysis, if any?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In")
data.clean.rus %>% select(ends_with(":Какие визуальные средства для анализа данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In")
data.clean.rus %>% select(ends_with(":Какие визуальные средства для анализа данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите")
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% select(ends_with(":Which..tool(s) do you use for data analysis, if any?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
TRUE ~ lib
))
})
world_tools <- c(world_tools,
list(data.clean.rus %>% select(ends_with(":Какие визуальные средства для анализа данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите")))
world_tools <- c(world_tools,
list("Россия" =
data.clean.rus %>%
select(ends_with(":Какие визуальные средства для анализа данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите"))
)
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% select(ends_with(":Which..tool(s) do you use for data analysis, if any?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
TRUE ~ lib
))
})
world_tools <- c(world_tools,
list("Россия" =
data.clean.rus %>%
select(ends_with(":Какие визуальные средства для анализа данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите"))
)
survey.designs.by.ctr <- list(
'США' = subset(data.clean.world, `What country do you live in?` == 'United States'),
'Япония' = subset(data.clean.world, `What country do you live in?` == 'Japan'),
'Китай' = subset(data.clean.world, `What country do you live in?` == 'China'),
'Европа' = subset(data.clean.world, `What country do you live in?` %in% europe_countries)
)
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% select(ends_with(":Which..tool(s) do you use for data analysis, if any?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
TRUE ~ lib
))
})
world_tools <- c(world_tools,
list("Россия" =
data.clean.rus %>%
select(ends_with(":Какие визуальные средства для анализа данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите"))
)
world_tools$Япония
Reduce(rbind, lapply(names(world_tools), function(n){
tools <- world_tools[[n]]
tools$ctr <- n
tools
}))
ggplot(Reduce(rbind, lapply(names(world_tools), function(n){
tools <- world_tools[[n]]
tools$ctr <- n
tools
})), aes(lib, share, fill=ctr, group=ctr)) + geom_bar(stat="identity", position = "dodge") + scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=15), legend.title = element_blank()) + coord_flip()
world_tools <- c(world_tools,
list("Россия" =
data.clean.rus %>%
select(ends_with(":Какие статистические пакеты для анализа/визуализации данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите") %>%
mutate(lib = if_else(lib == "Табличные редакторы (Microsoft Excel, OpenOffice Calc, Google Sheets и пр.)",
"Табличные редакторы", lib)))
)
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% select(ends_with(":Which statistics package(s) do you use to analyze and visualize..data, if any?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы"
TRUE ~ lib
df %>% select(ends_with(":Which statistics package(s) do you use to analyze and visualize..data, if any?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы",
TRUE ~ lib
))
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% select(ends_with(":Which statistics package(s) do you use to analyze and visualize..data, if any?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы",
TRUE ~ lib
))
})
world_tools <- c(world_tools,
list("Россия" =
data.clean.rus %>%
select(ends_with(":Какие статистические пакеты для анализа/визуализации данных Вы используете?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите") %>%
mutate(lib = if_else(lib == "Табличные редакторы (Microsoft Excel, OpenOffice Calc, Google Sheets и пр.)",
"Табличные редакторы", lib)))
)
ggplot(Reduce(rbind, lapply(names(world_tools), function(n){
tools <- world_tools[[n]]
tools$ctr <- n
tools
})), aes(lib, share, fill=ctr, group=ctr)) + geom_bar(stat="identity", position = "dodge") + scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=15), legend.title = element_blank()) + coord_flip()
df %>% select(ends_with(":What operating system(s) do you use as your work environment for data analysis?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы",
TRUE ~ lib
))
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% select(ends_with(":What operating system(s) do you use as your work environment for data analysis?"))  %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы",
TRUE ~ lib
))
})
world_tools <- c(world_tools,
list("Россия" =
data.clean.rus %>%
select(ends_with(":Какую операционную систему (системы) Вы используете в качестве рабочего окружения, когда занимаетесь анализом данных?")) %>%
tidyr::gather(lib, is.use) %>% group_by(lib) %>% summarise(share = mean(!is.na(is.use))) %>% ungroup() %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Другое — впишите") %>%
mutate(lib = if_else(lib == "Табличные редакторы (Microsoft Excel, OpenOffice Calc, Google Sheets и пр.)",
"Табличные редакторы", lib)))
)
ggplot(Reduce(rbind, lapply(names(world_tools), function(n){
tools <- world_tools[[n]]
tools$ctr <- n
tools
})), aes(lib, share, fill=ctr, group=ctr)) + geom_bar(stat="identity", position = "dodge") + scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=15), legend.title = element_blank()) + coord_flip()
data.clean.world %>% select(`What is the highest level of education you have completed?`) %>% tally()
data.clean.world %>% tally(`What is the highest level of education you have completed?`)
data.clean.world %>% group_by(`What is the highest level of education you have completed?`)  %>% tally()
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% filter(!is.na(`How long have you been working in data analysis?`)) %>%
group_by(`What is the highest level of education you have completed?`)  %>% tally() %>%
rename(lib, count) %>% mutate(share = count/sum(count)) %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы",
TRUE ~ lib
))
})
df %>% filter(!is.na(`How long have you been working in data analysis?`)) %>%
group_by(`What is the highest level of education you have completed?`)  %>% tally() %>%
setNames(c('lib', 'count')) %>% mutate(share = count/sum(count)) %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы",
TRUE ~ lib
))
world_tools <- lapply(survey.designs.by.ctr, function(df){
df %>% filter(!is.na(`How long have you been working in data analysis?`)) %>%
group_by(`What is the highest level of education you have completed?`)  %>% tally() %>%
setNames(c('lib', 'count')) %>% mutate(share = count/sum(count)) %>%
mutate(lib = stringr::str_replace(lib, ":.*", "")) %>% filter(lib != "Other ... Write In") %>%
mutate(lib = case_when(
lib == "None" ~ "Не использую",
lib == "Spreadsheet editor (Microsoft Excel, OpenOffice Calc, Google Sheets, etc.)" ~ "Табличные редакторы",
TRUE ~ lib
))
})
world_tools$США
data.clean.rus$`Укажите полученное Вами образование:`  %>% table
ggplot(Reduce(rbind, lapply(names(world_tools), function(n){
tools <- world_tools[[n]]
tools$ctr <- n
tools
})), aes(lib, share, fill=ctr, group=ctr)) + geom_bar(stat="identity", position = "dodge") + scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=15), legend.title = element_blank()) + coord_flip()
data.clean.world %>% select(`What is your manager's level of expertise in data analysis?` , `"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>% setNames(c("expertice", "satisfaction"))
data.clean.world$`What is your manager's level of expertise in data analysis?` %>% table
data.clean.world$`What is your manager's level of expertise in data analysis?` %>% levels
manager <- data.clean.world %>% select(`What is your manager's level of expertise in data analysis?` , `"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>% setNames(c("expertice", "satisfaction")) %>% mutate(expertice = levels(expertice))
data.clean.world$`What is your manager's level of expertise in data analysis?` %>% as.integer
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter() + geom_smooth()
manager <- data.clean.world %>% select(`What is your manager's level of expertise in data analysis?` , `"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>% setNames(c("expertice", "satisfaction")) %>% mutate(expertice = as.integer(expertice))
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter() + geom_smooth()
manager <- data.clean.world %>% select(`What is your manager's level of expertise in data analysis?` , `"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>% setNames(c("expertice", "satisfaction")) %>% mutate(expertice = as.real(as.integer(expertice)))
as.numeric(1)
is.real(as.numeric(1))
is.double(as.numeric(1))
manager <- data.clean.world %>% select(`What is your manager's level of expertise in data analysis?` , `"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>% setNames(c("expertice", "satisfaction")) %>% mutate(expertice = as.double(as.integer(expertice)))
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter() + geom_smooth()
manager <- data.clean.world %>%
select(`What is your manager's level of expertise in data analysis?` ,
`"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>%
setNames(c("expertice", "satisfaction")) %>%
mutate(expertice = as.double(as.integer(expertice)),
satisfaction = as.double((satisfaction)))
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter() + geom_smooth()
manager <- data.clean.world %>%
select(`What is your manager's level of expertise in data analysis?` ,
`"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>%
setNames(c("expertice", "satisfaction")) %>%
mutate(expertice = as.double(as.integer(expertice)),
satisfaction = as.double((satisfaction))) %>% filter(!is.na(expertice))
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter() + geom_smooth()
manager <- data.clean.world %>%
select(`What is your manager's level of expertise in data analysis?` ,
`"My manager gives me realistic assignments that are relevant to my skills and responsibilities, with a clear and specific description of the requirements.":To what extend do you associate the following phrase with your manager?..` ) %>%
setNames(c("expertice", "satisfaction")) %>%
mutate(expertice = as.double(as.integer(expertice)),
satisfaction = as.double((satisfaction))) %>% filter(!is.na(satisfaction))
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter() + geom_smooth()
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter() + geom_smooth(method="lm")
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter(size = 1) + geom_smooth(method="lm")
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter(size = 0.5) + geom_smooth(method="lm")
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter(size = 0.5) + geom_smooth(method="lm") + theme_bw() +
theme(legend.position = 'bottom',
axis.title.x=element_blank(),
axis.title.y=element_blank(), axis.text.y = element_text(size=15), legend.title = element_blank()) + coord_flip()
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter(size = 0.5) + geom_smooth(method="lm") + theme_bw() +
theme(legend.position = 'bottom', axis.text = element_text(size=15), legend.title = element_blank()) + coord_flip()
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter(size = 0.5) + geom_smooth(method="lm") + theme_bw() +
theme(legend.position = 'bottom',
axis.text = element_text(size=15),
axis.title  = element_text(size=15), legend.title = element_blank()) + coord_flip()
ggplot(manager, aes(expertice, satisfaction)) + geom_jitter(size = 0.5) + geom_smooth(method="lm") + theme_bw() +
theme(legend.position = 'bottom',
axis.text = element_text(size=15),
axis.title  = element_text(size=15), legend.title = element_blank())
ggplot(activities, aes(reorder(activity, share), share, fill= type, group=type)) + geom_bar(stat='identity', position = "dodge") +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) + theme_bw() +
theme(legend.position = 'bottom', axis.title.x=element_blank(),axis.text.y = element_text(size=15), axis.title.y=element_blank(), legend.title = element_blank()) + coord_flip()
